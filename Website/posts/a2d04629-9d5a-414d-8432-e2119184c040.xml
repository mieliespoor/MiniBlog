<?xml version="1.0" encoding="utf-8"?>
<post>
  <title>Convert WIX installer from perMachine to perUser</title>
  <slug>convert wix-installer-from-permachine-to-peruser</slug>
  <author>adminmarais</author>
  <pubDate>2016-10-03 07:14:47</pubDate>
  <lastModified>2016-10-03 18:11:59</lastModified>
  <excerpt>Converting an installer from a perMachine to a perUser installer is not that difficult a job, but there are a few things to look at and remember. I would be highlighting some of these here.</excerpt>
  <content>&lt;p&gt;We had a few projects for which we created installers using &lt;a href="http://wixtoolset.org/"&gt;&lt;u&gt;&lt;font color="#0066cc"&gt;http://wixtoolset.org/&lt;/font&gt;&lt;/u&gt;&lt;/a&gt;. At first we created the installers to be perMachine as there was no requirement to have it install perUser.&lt;/p&gt;&lt;p&gt;A little while after we got this done, the call was made to remove admin rights for all users in the company. Now suddenly we required admin privileges to install the product, which naturally made things slightly more complicated.&lt;/p&gt;&lt;p&gt;Since the application was a ClickOnce deployment before we create the standalone installer, it was an easy choice to change it to a perUser installer.&lt;/p&gt;&lt;p&gt;The important thing to remember is that a perMachine installation installs the product to the Program Files folder, whereas a perUser installation would install the product to the user's local AppData folder - for which you do not need admin privileges.&lt;/p&gt;&lt;p&gt;Firstly, we will be changing the InstallScope property from perMachine to perUser. Doing this, WIX would then go and set a few properties in the background for you, to notify the MSI that it can't be installed required elevated privileges.&lt;br /&gt;&lt;/p&gt;&lt;p&gt;Next up, you have to change the directory where the product would be installed to. Earlier,&amp;nbsp;I mentioned that it can't be installed to the ProgramFiles directory anymore, so you can set your directory to point to the LocalAppDataFolder:&lt;/p&gt;&lt;p&gt;&lt;span style="background:white;color:blue;line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;&amp;lt;&lt;/span&gt;&lt;span style="background:white;color:rgb(163,21,21);line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;Directory&lt;/span&gt;&lt;span style="background:white;color:blue;line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;&lt;span style="background:white;color:red;line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;Id&lt;/span&gt;&lt;span style="background:white;color:blue;line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;=&lt;/span&gt;&lt;span style="background:white;color:black;line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;"&lt;/span&gt;&lt;span style="background:white;color:blue;line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;LocalAppDataFolder&lt;/span&gt;&lt;span style="background:white;color:black;line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;"&lt;/span&gt;&lt;span style="background:white;color:blue;line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;&lt;span style="background:white;color:red;line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;Name&lt;/span&gt;&lt;span style="background:white;color:blue;line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;=&lt;/span&gt;&lt;span style="background:white;color:black;line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;"&lt;/span&gt;&lt;span style="background:white;color:blue;line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;AppData&lt;/span&gt;&lt;span style="background:white;color:black;line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;"&lt;/span&gt;&lt;span style="background:white;color:blue;line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span style="background:white;color:rgb(163,21,21);line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;Directory&lt;/span&gt;&lt;span style="background:white;color:blue;line-height:107%;font-family:Consolas;font-size:9.5pt;mso-bidi-font-family:Consolas;mso-highlight:white"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;The big change with going perUser, is that you have to explicitly tell Windows Installer to remove all directories you create on the file system. To make this a bit easier, I wrap all components being installed to a specific dir inside a DirectoryRef element. Inside of the component, you can the add your CreateFolder and RemoveFolder elements. One thing that is also important, is that you also have to&amp;nbsp;create a registry key to keep track of your folder you created.&lt;font color="#000000" face="Times New Roman" size="3"&gt;&lt;br /&gt;&lt;/font&gt;&lt;/p&gt;</content>
  <ispublished>false</ispublished>
  <categories>
    <category>WIX</category>
    <category>Dev</category>
    <category>ALM</category>
  </categories>
  <comments></comments>
</post>